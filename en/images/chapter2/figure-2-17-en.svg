<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 540 180">
  <style>
    .bg { fill: #f8f9fa; }
    .box { fill: #fff; stroke: #1890ff; stroke-width: 1.5; rx: 5; }
    .box-loss { fill: #fff; stroke: #cf1322; stroke-width: 1.5; rx: 5; }
    .box-act { fill: #fff; stroke: #52c41a; stroke-width: 1.5; rx: 5; }
    .label { font-family: 'Georgia', 'Times New Roman', serif; font-size: 11px; fill: #333; font-style: italic; text-anchor: middle; }
    .label-sm { font-family: 'Georgia', 'Times New Roman', serif; font-size: 9.5px; fill: #555; font-style: italic; text-anchor: middle; }
    .anno { font-family: 'Arial', sans-serif; font-size: 8.5px; fill: #999; text-anchor: middle; }
    .anno-fwd { font-family: 'Arial', sans-serif; font-size: 9px; fill: #1890ff; font-weight: bold; text-anchor: middle; }
    .anno-bwd { font-family: 'Arial', sans-serif; font-size: 9px; fill: #cf1322; font-weight: bold; text-anchor: middle; }
    .fwd { stroke: #1890ff; stroke-width: 1.2; fill: none; }
    .bwd { stroke: #cf1322; stroke-width: 1.2; fill: none; stroke-dasharray: 4,2; }
  </style>
  <defs>
    <marker id="arr-fwd" markerWidth="6" markerHeight="4" refX="6" refY="2" orient="auto">
      <path d="M0,0 L6,2 L0,4 Z" fill="#1890ff"/>
    </marker>
    <marker id="arr-bwd" markerWidth="6" markerHeight="4" refX="6" refY="2" orient="auto">
      <path d="M0,0 L6,2 L0,4 Z" fill="#cf1322"/>
    </marker>
  </defs>

  <rect width="540" height="185" class="bg"/>

  <!-- FORWARD label -->
  <text x="270" y="16" class="anno-fwd">forward pass →</text>

  <!-- Boxes row, y centered at 65 -->
  <!-- x -->
  <rect x="12" y="42" width="40" height="30" class="box"/>
  <text x="32" y="61" class="label">x</text>

  <!-- W1, b1 -->
  <rect x="80" y="42" width="58" height="30" class="box"/>
  <text x="109" y="55" class="label-sm">W₁x + b₁</text>
  <text x="109" y="66" class="anno">(linear)</text>

  <!-- ReLU -->
  <rect x="166" y="42" width="44" height="30" class="box-act"/>
  <text x="188" y="61" class="label">ReLU</text>

  <!-- h -->
  <rect x="238" y="42" width="32" height="30" class="box"/>
  <text x="254" y="61" class="label">h</text>

  <!-- W2, b2 -->
  <rect x="298" y="42" width="58" height="30" class="box"/>
  <text x="327" y="55" class="label-sm">W₂h + b₂</text>
  <text x="327" y="66" class="anno">(linear)</text>

  <!-- softmax -->
  <rect x="384" y="42" width="54" height="30" class="box-act"/>
  <text x="411" y="61" class="label-sm">softmax</text>

  <!-- ŷ -->
  <rect x="438" y="42" width="32" height="30" class="box"/>
  <text x="454" y="61" class="label">ŷ</text>

  <!-- L -->
  <rect x="490" y="42" width="36" height="30" class="box-loss"/>
  <text x="508" y="61" class="label" style="fill:#cf1322">L</text>

  <!-- FORWARD ARROWS (top, solid blue) -->
  <line x1="52" y1="50" x2="78" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>
  <line x1="138" y1="50" x2="164" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>
  <line x1="210" y1="50" x2="236" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>
  <line x1="270" y1="50" x2="296" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>
  <line x1="356" y1="50" x2="382" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>
  <line x1="438" y1="50" x2="438" y2="50" class="fwd"/>
  <line x1="470" y1="50" x2="488" y2="50" class="fwd" marker-end="url(#arr-fwd)"/>

  <!-- BACKWARD ARROWS (bottom, dashed red) -->
  <text x="270" y="108" class="anno-bwd">← backward pass (gradients)</text>

  <line x1="490" y1="78" x2="472" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>
  <line x1="438" y1="78" x2="440" y2="78" class="bwd"/>
  <line x1="384" y1="78" x2="360" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>
  <line x1="298" y1="78" x2="272" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>
  <line x1="238" y1="78" x2="212" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>
  <line x1="166" y1="78" x2="140" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>
  <line x1="80" y1="78" x2="54" y2="78" class="bwd" marker-end="url(#arr-bwd)"/>

  <!-- Gradient labels underneath each arrow -->
  <text x="508" y="92" class="anno" style="fill:#cf1322">∂L/∂ŷ</text>
  <text x="411" y="92" class="anno" style="fill:#cf1322">δ₂</text>
  <text x="327" y="92" class="anno" style="fill:#cf1322">∂L/∂h</text>
  <text x="188" y="92" class="anno" style="fill:#cf1322">δ₁</text>
  <text x="109" y="92" class="anno" style="fill:#cf1322">∂L/∂W₁</text>

  <!-- softmax → ŷ arrow (they're adjacent) -->
  <line x1="438" y1="57" x2="438" y2="57" class="fwd"/>

  <!-- Parameter callouts dropping below W1 and W2 boxes -->
  <line x1="109" y1="72" x2="109" y2="125" stroke="#1890ff" stroke-width="0.6" stroke-dasharray="2,2"/>
  <text x="109" y="136" class="anno" style="fill:#1890ff">update W₁, b₁</text>

  <line x1="327" y1="72" x2="327" y2="125" stroke="#1890ff" stroke-width="0.6" stroke-dasharray="2,2"/>
  <text x="327" y="136" class="anno" style="fill:#1890ff">update W₂, b₂</text>

  <!-- Bottom note -->
  <text x="270" y="168" class="anno">each box computes a local derivative; the chain rule multiplies them together</text>

  <!-- Explanation of ŷ → L being combined -->
  <text x="454" y="35" class="anno">−log(ŷₖ)</text>
</svg>
